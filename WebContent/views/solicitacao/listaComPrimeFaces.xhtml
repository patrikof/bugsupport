<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="/templates/Menu.xhtml"
	xmlns:p="http://primefaces.prime.com.tr/ui">

	<ui:define name="content">
<h:form id="f132" class="form-horizontal no-print" role="form" >

<div class="col-sm-12">		
<div class="panel panel-primary">
  <div class="panel-heading">
    <h2 class="panel-title text-center no-print" style="font-weight: bold;" >Pesquisa de Solicitações</h2>
  </div>
  <div class="panel-body">	
		
<div class="row">
  <div class="col-xs-12 col-sm-6 col-md-4">
   <div class="">  
    <div class=""> 
			<label  class="control-label">Código da Solicitação:</label>
			 
			<h:inputText  class="form-control"
				value="#{buscaSolicitacaoBean.id}"  id="codigo"
				label="Código da Solicitação"
				converterMessage="Digite apenas números inteiros.">
				<f:convertNumber integerOnly="true" />
			</h:inputText>
			<h:message for="codigo" />
	</div>		
	 </div>
  </div>
  
  <div class="col-xs-12 col-sm-6 col-md-4">
  		<div class="">
  		<div class="">
			<label class="control-label">Tipo de Solicitação:</label> 
			
			<h:selectOneMenu class="form-control"
				 value="#{buscaSolicitacaoBean.tipoSolicitacao}"
				id="tiposolicitacao" label="Tipo de Solicitação">
				<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
				<f:selectItems value="#{tipoSolicitacaoBean.listagem}"
					var="tpsolicitacao" itemValue="#{tpsolicitacao.id}"
					itemLabel="#{tpsolicitacao.descricao}" />
		
			</h:selectOneMenu>
			<h:message for="tiposolicitacao" />
		</div>
		</div>		
	</div>

  <div class="col-xs-12 col-sm-6 col-md-4" >

	<div class="">
	<div class="">
			<label class="control-label">Status:</label> 
			
				<h:selectOneMenu class="form-control"
					 value="#{buscaSolicitacaoBean.status}"
					id="status" label="Status">
					<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
					<f:selectItems value="#{statusBean.listagem}" var="st"
						itemValue="#{st.id}" itemLabel="#{st.descricao}" />
				</h:selectOneMenu>
				<h:message for="status" />
	</div> 
	</div> 
  </div>
</div>

<div class="row">
  <div class="col-xs-12 col-sm-6 col-md-4">

	<!-- <label>Data de Cadastro:</label> 				
				<p:calendar pattern="dd/MM/yyyy" value="#{buscaSolicitacaoBean.dataCadastroInicial}"
				 id="popupButtonCal" showOn="button" converterMessage="Digite uma data inicial válida.">				
				<f:convertDateTime pattern="dd/MM/yyyy" type="date"
					dateStyle="short" timeZone="GMT-3" />				
			</p:calendar>&nbsp;<strong>a</strong>&nbsp;<p:calendar pattern="dd/MM/yyyy" value="#{buscaSolicitacaoBean.dataCadastroFinal}" id="popupButtonCal2" showOn="button" 
				 converterMessage="Digite uma data final válida.">
				<f:convertDateTime  pattern="dd/MM/yyyy" type="date" dateStyle="short" timeZone="GMT-3"  />
			</p:calendar>
	 -->		
			
		<div class="">		
			<label class="control-label">Data de Cadastro:</label>
			<div class="input-group">
				<h:inputText id="dtCadIni"  value="#{buscaSolicitacaoBean.dataCadastroInicial}" class="form-control form_date" >
					<f:convertDateTime pattern="dd/MM/yyyy" type="date"	dateStyle="short" timeZone="GMT-3" />
				</h:inputText>				
				<label class="input-group-addon">a</label>  
				<h:inputText id="dtCadFim"  value="#{buscaSolicitacaoBean.dataCadastroFinal}" class="form-control form_date">
					<f:convertDateTime pattern="dd/MM/yyyy" type="date"	dateStyle="short" timeZone="GMT-3" />
				</h:inputText>
			</div>
		</div>
  
  </div>
  <div class="col-xs-12 col-sm-6 col-md-4">  
	<div class="">
	<div class="">
			<label class="control-label">Versão:</label> <h:selectOneMenu class="form-control"
				 value="#{buscaSolicitacaoBean.versao}"
				id="versao" label="Versão">
				<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
				<f:selectItems value="#{versaoBean.listagem}" var="v"
					itemValue="#{v.id}" itemLabel="#{v.descricao}" />
			</h:selectOneMenu>
			<h:message for="versao" />
	</div>
	</div>	    
  </div>
  
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Cliente:</label> <h:selectOneMenu class="form-control"
				 value="#{buscaSolicitacaoBean.cliente}"
				id="cliente" label="Cliente">
				<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
				<f:selectItems value="#{clienteBean.listagem}" var="cli"
					itemValue="#{cli.id}" itemLabel="#{cli.nomeFantasia}" />
			</h:selectOneMenu>
			<h:message for="cliente" />
	</div>	
	</div> 
  </div>
</div>



<div class="row">
  <div class="col-xs-12 col-sm-6 col-md-4">
		
<div class="">

			<label class="control-label">Data de Alteração:</label>
			<div class="input-group">
				<h:inputText id="dtAltIni" value="#{buscaSolicitacaoBean.dataAtualizacaoInicial}" class="form-control form_date" >
					<f:convertDateTime pattern="dd/MM/yyyy" type="date"	dateStyle="short" timeZone="GMT-3" />
				</h:inputText>				
				<span class="input-group-addon">a</span>  
				<h:inputText id="dtAltFim" value="#{buscaSolicitacaoBean.dataAtualizacaoFinal}" class="form-control form_date">
					<f:convertDateTime pattern="dd/MM/yyyy" type="date"	dateStyle="short" timeZone="GMT-3" />
				</h:inputText>
				
		</div>			  
  </div>
  </div>
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Pessoa do Contato:</label>
			<h:inputText class="form-control"
					 value="#{buscaSolicitacaoBean.pessoaContato}"
					id="contato" label="Pessoa do Contato"
					validatorMessage="O tamanho máximo permitido para a Pessoa do Contato é de 50 caracteres.">
					<f:validateLength maximum="50" />
			</h:inputText>
			<h:message for="contato" />
	</div>		
	</div>  
  </div>
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Prioridade:</label>
			<h:selectOneMenu class="form-control"
					 value="#{buscaSolicitacaoBean.prioridade}"
					id="prioridade" label="Prioridade">
					<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
					<f:selectItems value="#{prioridadeBean.listagem}" var="pr"
						itemValue="#{pr.id}" itemLabel="#{pr.descricao}" />
			</h:selectOneMenu>
			<h:message for="prioridade" />
	</div>
	
  </div>
</div>
</div>
<div class="row">
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Produto:</label>
			<h:selectOneMenu class="form-control"
				 value="#{buscaSolicitacaoBean.produto}"
				id="produto" label="Produto">
				<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
				<f:selectItems value="#{produtoBean.listagem}" var="prod"
					itemValue="#{prod.id}" itemLabel="#{prod.descricao}" />
			</h:selectOneMenu>
	<h:message for="produto" />
	</div>	
  </div>
  </div>
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Assunto:</label>			
			<h:inputText class="form-control" 
				value="#{buscaSolicitacaoBean.assunto}" id="assunto" label="Assunto"
				validatorMessage="O tamanho máximo permitido para o Assunto é de 80 caracteres.">
				<f:validateLength maximum="80" />
			</h:inputText>
			<h:message for="assunto" />
	</div>  
  </div>
  </div>
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Responsável:</label>
			<h:selectOneMenu class="form-control"
				 value="#{buscaSolicitacaoBean.responsavel}"
				id="responsavel" label="Responsável">
				<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
				<f:selectItem itemValue="-1" itemLabel=" -- Não Atribuido -- " />
				<f:selectItems value="#{usuarioBean.listagem}" var="usrResp"
					itemValue="#{usrResp.id}" itemLabel="#{usrResp.nome}" />
			</h:selectOneMenu>
			<h:message for="responsavel" />
	</div>
	  
  </div>
</div>
</div>

<div class="row">
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Sistema Operacional:</label>
			<h:selectOneMenu class="form-control"				
				value="#{buscaSolicitacaoBean.sistemaOperacional}"
				id="sistemaoperacional" label="Sistema Operacional">
				<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
				<f:selectItems value="#{sistemaOperacionalBean.listagem}" var="so"
					itemValue="#{so.id}" itemLabel="#{so.descricao}" />
			</h:selectOneMenu>
			<h:message for="sistemaoperacional" />
	</div>
	 </div>
  </div>
  <div class="col-xs-12 col-sm-6 col-md-4">
  <div class="">
  <div class="">
			<label class="control-label">Atendente:</label>
			<h:selectOneMenu class="form-control"
				 value="#{buscaSolicitacaoBean.atendente}"
				id="atendente" label="Atendente">
				<f:selectItem itemValue="" itemLabel=" -- Selecionar -- " />
				<f:selectItem itemValue="-1" itemLabel=" -- Não Atribuido -- " />
				<f:selectItems value="#{usuarioBean.listagem}" var="usrAtend"
					itemValue="#{usrAtend.id}" itemLabel="#{usrAtend.nome}" />
			</h:selectOneMenu>
			<h:message for="responsavel" />
	</div>	  
  </div>
</div>				
</div>				 
	
	</div>
	</div>
	</div>
&nbsp;&nbsp;&nbsp;&nbsp;<h:commandButton value="Pesquisar" id="btnPesquisa" action="#{buscaSolicitacaoBean.pesquisar}" class="btn btn-large btn-primary" />                 
             &nbsp;
			 <h:commandButton value="Limpar Pesquisa" id="btnLimpar" action="#{buscaSolicitacaoBean.listar}" class="btn btn-large btn-primary" />
    
	</h:form>	
	
	<br/>
<h:form id="form2" class="clear">
<div class="col-sm-12">	
<div class="panel panel-primary">
  <div class="panel-heading">
    <h2 class="panel-title text-center" style="font-weight: bold;" >Relação de Solicitações</h2>
  </div>
  		<hr />
		<div class="clear"></div>
		
		<h:messages id="message" style="color:blue" />
		
		<!-- style="font-size: 1.0em" colocando na table antes resolvia problema de passar do cabeçalho
		
		COLOCAR A CLASS paginacaoDinamica QUANDO TRANSFORMAR PARA DATATABLES!!!!!!!!!
		
		
		-->
			<p:dataTable id="tblSolicitacoes"
				value="#{buscaSolicitacaoBean.lazySolicitacoesDataModel}" var="a"
				 paginator="true" rowKey="#{a.id}" rows="10" emptyMessage="Nenhum registro encontrado"
				paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="10,20,30,300" lazy="true" dinamic="true" selectionMode="single">
			
				<!-- <f:facet name="header">Relação de Solicitações</f:facet> -->
				<p:column id="modelHeader" sortBy="#{a.id}">
					<f:facet name="header">
						<h:outputText value="Código" />
					</f:facet>
					<h:outputText value="#{a.id}" />
				</p:column>
				<p:column sortBy="#{a.cliente.nomeFantasia}">
					<f:facet name="header">
						<h:outputText value="Cliente" />
					</f:facet>
					<h:outputText value="#{a.cliente.nomeFantasia}" />
				</p:column>
				<p:column sortBy="#{a.produto.descricao}">
					<f:facet name="header">
						<h:outputText value="Produto" />
					</f:facet>
					<h:outputText value="#{a.produto.descricao}" />
				</p:column>
				<p:column sortBy="#{a.assunto}">
					<f:facet name="header">
						<h:outputText value="Assunto" />
					</f:facet>
					<h:outputText value="#{a.assunto}" />
				</p:column>

				<p:column sortBy="#{a.responsavel.login}">
					<f:facet name="header">
						<h:outputText value="Responsável" />
					</f:facet>
					<h:outputText value="#{a.responsavel.login}" />
				</p:column>
				<p:column sortBy="#{a.dataCadastro}">
					<f:facet name="header">
						<h:outputText value="Data do Cadastro" />
					</f:facet>
					<h:outputText value="#{a.dataCadastro}">
						<f:convertDateTime pattern="dd/MM/yyyy" />
					</h:outputText>
				</p:column>
				<p:column styleClass="no-print">
				    <f:facet name="header">
						<h:outputText styleClass="glyphicon glyphicon-list-alt" />
					</f:facet>
					<h:link styleClass="glyphicon glyphicon-list-alt" outcome="detalhes" >
						<f:param name="param1" value="#{a.id}" />
					</h:link>
				</p:column>
				<p:column styleClass="no-print">
					<f:facet name="header">
						<h:outputText styleClass="glyphicon glyphicon-user" />
					</f:facet>
					<h:commandLink styleClass="glyphicon glyphicon-user"
						action="#{solicitacaoBean.alterarResponsavel(a.id)}">
						<!-- <f:setPropertyActionListener value="#{a.id}"
							target="#{solicitacaoBean.solicitacao.id}" />
						<f:ajax execute="@this" render="@form"></f:ajax> -->
					</h:commandLink>
				</p:column>
				<p:column styleClass="no-print">
					<f:facet name="header">
						<h:outputText styleClass="glyphicon glyphicon-edit" />
					</f:facet>
					<h:commandLink  styleClass="glyphicon glyphicon-edit" action="#{solicitacaoBean.alterar(a.id)}">
						<!-- <f:setPropertyActionListener value="#{a.id}"
							target="#{solicitacaoBean.solicitacao.id}" />
						<f:ajax execute="@this" render="@form"></f:ajax> -->
					</h:commandLink>
				</p:column>
				<p:column styleClass="no-print">
					<f:facet name="header">
						<h:outputText styleClass="glyphicon glyphicon-remove" />
					</f:facet>
					<h:commandLink styleClass="glyphicon glyphicon-remove" action="#{solicitacaoBean.remover(a.id)}"
					onclick="if (!confirm('Deseja realmente excluir a solicitação \'#{a.assunto}\'?')){ return false};" >
						<!-- <f:setPropertyActionListener value="#{a}"
							target="#{solicitacaoBean.solicitacao}" />
						<f:ajax execute="@this" render="@form"></f:ajax> -->
					</h:commandLink>
				</p:column>				
			</p:dataTable>			
			<br/>
			</div>
  </div>		
&nbsp;&nbsp;&nbsp;&nbsp;<h:commandButton value="Gerar PDF" action="#{buscaSolicitacaoBean.gerarPdf}" class="btn btn-large btn-primary no-print" />
		
		</h:form>  
	</ui:define>
</ui:composition>
